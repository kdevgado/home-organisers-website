---
/**
 * Props:
 *  - before (string)
 *  - after  (string)
 *  - alt    (string)
 *  - labelBefore? (string)
 *  - labelAfter?  (string)
 *  - start? (0â€“100)
 */
const {
  before,
  after,
  alt = 'Before and after comparison',
  labelBefore = 'Before',
  labelAfter = 'After',
  start = 50
} = Astro.props;
---
<div class="ba" style={`--pos:${start}%`} data-start={start}>
  <img class="ba-img ba-after" src={after} alt={alt} loading="eager" />
  <img class="ba-img ba-before" src={before} alt="" aria-hidden="true" loading="eager" />

  <div class="ba-handle" aria-hidden="true"></div>
  <input
    class="ba-range"
    type="range"
    min="0"
    max="100"
    value={start}
    aria-label="Slide to compare before and after"
  />

  <div class="ba-label ba-label--before">{labelBefore}</div>
  <div class="ba-label ba-label--after">{labelAfter}</div>
</div>

<style>
  .ba {
    --pos: 50%;
    position: relative;
    width: 100%;
    aspect-ratio: 4 / 3;
    border-radius: var(--radius, 14px);
    overflow: hidden;
    box-shadow: var(--shadow, 0 10px 30px rgba(2,8,23,.08));
    background: #f7f4f1;
    touch-action: none;
  }
  @media (min-width: 1200px) { .ba { aspect-ratio: 3 / 2; } }
  @media (max-width: 700px)  { .ba { aspect-ratio: 4 / 3; } }

  .ba-img {
    position: absolute; inset: 0;
    width: 100%; height: 100%;
    object-fit: cover; object-position: bottom center;
    user-select: none; -webkit-user-drag: none; pointer-events: none;
  }
  .ba-before { clip-path: inset(0 calc(100% - var(--pos)) 0 0); }

  .ba-handle {
    position: absolute; top: 0; bottom: 0; left: var(--pos);
    transform: translateX(-50%); width: 2px;
    background: rgba(15, 23, 42, .35); pointer-events: none;
  }
  .ba-handle::after {
    content: ""; position: absolute; top: 50%; left: 50%;
    transform: translate(-50%,-50%);
    width: 18px; height: 18px; border-radius: 50%;
    background: #fff; border: 2px solid rgba(15,23,42,.4);
    box-shadow: 0 4px 12px rgba(0,0,0,.15);
  }

  .ba-range {
    position: absolute; inset: 0; width: 100%; height: 100%;
    opacity: 0; cursor: ew-resize; z-index: 2; touch-action: none;
  }

  .ba-label {
    position: absolute; top: 10px; padding: .25rem .5rem;
    font-weight: 700; font-size: .9rem; border-radius: .5rem;
    background: rgba(0,0,0,.5); color: #fff; text-shadow: 0 1px 2px rgba(0,0,0,.25);
    user-select: none; pointer-events: none; z-index: 1;
  }
  .ba-label--before { left: 10px; }
  .ba-label--after  { right: 10px; }
</style>

<!-- External logic only -->
<script src="/js/ba.js" type="module" defer></script>
